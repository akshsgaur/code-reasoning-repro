[
  {
    "submission_id": 1643600049,
    "code": "class Solution:\n  def lexicographicallySmallestString(self, a: str) -> str:\n    b = len(a)\n    if b == 0: return \"\"\n    def f(x, y): return abs(ord(x) - ord(y)) == 1 or {x, y} == {'a', 'z'}\n    c = [[False] * b for _ in range(b)]\n    for d in range(2, b + 1, 2):\n      for e in range(b - d + 1):\n        j = e + d - 1\n        if f(a[e], a[j]) and (j - e == 1 or c[e + 1][j - 1]): c[e][j] = True\n        else:\n          for g in range(2, d, 2):\n            if c[e][e + g - 1] and c[e + g][j]: c[e][j] = True; break\n    h = [\"\"] * (b + 1)\n    for i in range(b - 1, -1, -1):\n      j = min(a[i:], a[i] + h[i + 1])\n      for k in range(i + 1, b):\n        if f(a[i], a[k]) and (k - i == 1 or c[i + 1][k - 1]): j = min(j, h[k + 1])\n      h[i] = j\n    return h[0]\n",
    "lang": "python3",
    "question_id": 3867,
    "contest_submission": 24261146
  },
  {
    "submission_id": 1643613833,
    "code": "class Solution:\n    def lexicographicallySmallestString(self, s: str) -> str:\n        n = len(s)\n        v = [ord(c) - ord('a') for c in s]\n        arr = [[False]*26 for _ in range(26)]\n        for c in range(26):\n            arr[c][(c+1)%26] = True\n            arr[c][(c-1)%26] = True\n        red = [[False]*n for _ in range(n)]\n        for le in range(2, n+1, 2):\n            for i in range(n - le + 1):\n                j = i + le - 1\n                c1 = v[i]\n                for k in range(i+1, j+1, 2):\n                    c2 = v[k]\n                    if not arr[c1][c2]:\n                        continue\n                    if i+1 <= k-1 and not red[i+1][k-1]:\n                        continue\n                    if k+1 <= j and not red[k+1][j]:\n                        continue\n                    red[i][j] = True\n                    break\n        keep = [0]*(n+1)\n        keepp = [0]*(n+1)\n        keep[n] = 2\n        compMemo = {}\n        \n        def first(h, p):\n            if h is not None:\n                return v[h], (None, p)\n            while p < n:\n                k = keep[p]\n                if k == 2:\n                    return None, (None, n)\n                if k == 0:\n                    return v[p], (None, p+1)\n                p = keepp[p] + 1\n            return None, (None, n)\n        \n        def small(h1, p1, h2, p2):\n            key = (h1, p1, h2, p2)\n            if key in compMemo:\n                return compMemo[key]\n            c1, nxt1 = first(h1, p1)\n            c2, nxt2 = first(h2, p2)\n            if c1 is None and c2 is None:\n                compMemo[key] = False\n                return False\n            if c1 is None:\n                compMemo[key] = True\n                return True\n            if c2 is None:\n                compMemo[key] = False\n                return False\n            if c1 != c2:\n                res = c1 < c2\n                compMemo[key] = res\n                return res\n            res = small(nxt1[0], nxt1[1], nxt2[0], nxt2[1])\n            compMemo[key] = res\n            return res\n        \n        for i in range(n-1, -1, -1):\n            best_h, best_p = i, i+1\n            c1 = v[i]\n            for k in range(i+1, n, 2):\n                c2 = v[k]\n                if not arr[c1][c2]:\n                    continue\n                if i+1 <= k-1 and not red[i+1][k-1]:\n                    continue\n                cand_h, cand_p = None, k+1\n                if small(cand_h, cand_p, best_h, best_p):\n                    best_h, best_p = cand_h, cand_p\n            if best_h == i:\n                keep[i] = 0\n            else:\n                keep[i] = 1\n                keepp[i] = best_p - 1\n        \n        res = []\n        h, p = None, 0\n        while True:\n            c, (nh, np) = first(h, p)\n            if c is None:\n                break\n            res.append(chr(c + ord('a')))\n            h, p = nh, np\n        \n        return \"\".join(res)\n",
    "lang": "python3",
    "question_id": 3867,
    "contest_submission": 24271252
  },
  {
    "submission_id": 1643592447,
    "code": "class Solution:\n    def lexicographicallySmallestString(self, s: str) -> str:\n        n = len(s)\n\n        def helper(c1 ,c2):\n          o1, o2 = ord(c1), ord(c2)\n          return abs(o1 - o2) == 1 or abs(o1 - o2) == 25\n\n        mp = collections.defaultdict(bool)\n\n        for l in range(2, n + 1, 2):\n          for i in range(n - l + 1):\n            j = i + l - 1\n\n            if helper(s[i], s[j]):\n              if l == 2 or mp[i + 1, j - 1]:\n                mp[i, j] = True\n                continue\n\n            for k in range(i + 1, j, 2):\n              if mp[i, k] and mp[k + 1, j]:\n                mp[i, j] = True\n                break\n\n        dp = [\"\"] * (n + 1)\n        \n        for i in range(n - 1, -1, -1):\n          dp[i] = s[i] + dp[i + 1]\n          for j in range(i + 1, n, 2):\n            if mp[i, j]:\n              if dp[j + 1] < dp[i]:\n                dp[i] = dp[j + 1]\n                \n        return dp[0]",
    "lang": "python3",
    "question_id": 3867,
    "contest_submission": 24255343
  }
]