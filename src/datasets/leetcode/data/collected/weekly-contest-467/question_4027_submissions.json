[
  {
    "submission_id": 1769952969,
    "code": "class Solution:\n    def countStableSubsequences(self, nums: List[int]) -> int:\n        MOD = 10**9 + 7\n        res = 0\n\n        @cache\n        def dp(i, pp, p):\n            if i == len(nums):\n                return 1\n            ifSkip = dp(i + 1, pp, p)\n            v = nums[i]\n            if v % 2 == pp == p:\n                return ifSkip\n            ifTake = dp(i + 1, p, v % 2)\n            return (ifSkip + ifTake) % MOD\n\n        res = dp(0, -1, -1)\n        dp.cache_clear()\n        return res - 1",
    "lang": "python3",
    "question_id": 4027,
    "contest_submission": 26424322
  },
  {
    "submission_id": 1769973511,
    "code": "class Solution:\n  def countStableSubsequences(self, nums: List[int]) -> int:\n    MOD = 1_000_000_007\n    E1 = E2 = O1 = O2 = 0\n\n    for a in nums:\n        if a % 2 == 0:\n            newE1 = (E1 + O1 + O2 + 1) % MOD\n            newE2 = (E2 + E1) % MOD\n            E1, E2 = newE1, newE2\n        else:\n            newO1 = (O1 + E1 + E2 + 1) % MOD\n            newO2 = (O2 + O1) % MOD\n            O1, O2 = newO1, newO2\n    return (E1 + E2 + O1 + O2) % MOD",
    "lang": "python3",
    "question_id": 4027,
    "contest_submission": 26440723
  },
  {
    "submission_id": 1769974365,
    "code": "class Solution:\n    def countStableSubsequences(self, nums: List[int]) -> int:\n        modulo = 10**9 + 7\n\n        nums = [x%2 for x in nums]\n\n        @lru_cache(None)\n        def recur_fn(i,prev,count):\n            if i == len(nums):\n                return 0\n            else:\n                res = 0\n                if nums[i] == prev and count == 1:\n                    res += 1 + recur_fn(i+1,prev,count+1)\n                    if res >= modulo:\n                        res %= modulo\n                if nums[i] != prev:\n                    res += 1+ recur_fn(i+1,nums[i],1)\n                    if res >= modulo:\n                        res %= modulo\n                res += recur_fn(i+1,prev,count)\n                if res >= modulo:\n                    res %= modulo\n                return res \n\n        ans = 0\n        for i in range(len(nums)):\n            ans += 1 + recur_fn(i+1,nums[i],1)\n            #print('ans',ans)\n            if ans >= modulo:\n                ans %= modulo\n            \n        recur_fn.cache_clear()\n        return ans%modulo",
    "lang": "python3",
    "question_id": 4027,
    "contest_submission": 26441366
  },
  {
    "submission_id": 1769975070,
    "code": "class Solution:\n    def countStableSubsequences(self, nums: List[int]) -> int:\n        mod = 10 ** 9 + 7\n        dp = [[0, 0], [0, 0]]\n        for x in nums:\n            if x % 2 == 1:\n                dp[0][1] += dp[0][0]\n                dp[0][0] += dp[1][0] + dp[1][1] + 1\n                dp[0][0] %= mod\n                dp[0][1] %= mod\n            else:\n                dp[1][1] += dp[1][0]\n                dp[1][0] += dp[0][0] + dp[0][1] + 1\n                dp[1][0] %= mod\n                dp[1][1] %= mod\n        return (sum(dp[0]) + sum(dp[1])) % mod\n        ",
    "lang": "python3",
    "question_id": 4027,
    "contest_submission": 26441893
  },
  {
    "submission_id": 1769977174,
    "code": "class Solution:\n    def countStableSubsequences(self, nums: List[int]) -> int:\n        m = nums\n        MOD = 10**9+7\n        e1,e2,o1,o2=0,0,0,0\n        for num in m:\n            if num%2==0:\n                ne1=(e1+o1+o2+1)%MOD\n                ne2=(e1+e2)%MOD\n                e1,e2=ne1,ne2\n            else:\n                no1=(o1+e1+e2+1)%MOD\n                no2=(o1+o2)%MOD\n                o1,o2=no1,no2\n        result = (e1+e2+o1+o2)%MOD\n        return result",
    "lang": "python3",
    "question_id": 4027,
    "contest_submission": 26443434
  },
  {
    "submission_id": 1769978339,
    "code": "class Solution:\n    def countStableSubsequences(self, nums: List[int]) -> int:\n        MOD = 10**9 + 7\n        even1 = even2 = odd1 = odd2 = 0\n        for val in nums:\n            if val % 2 == 0:\n                new_even1 = (even1 + odd1 + odd2 + 1) % MOD\n                new_even2 = (even2 + even1) % MOD\n                even1, even2 = new_even1, new_even2\n            else:\n                new_odd1 = (odd1 + even1 + even2 + 1) % MOD\n                new_odd2 = (odd2 + odd1) % MOD\n                odd1, odd2 = new_odd1, new_odd2\n        return (even1 + even2 + odd1 + odd2) % MOD",
    "lang": "python3",
    "question_id": 4027,
    "contest_submission": 26444261
  },
  {
    "submission_id": 1769981844,
    "code": "MOD = 10 ** 9 + 7\nclass Solution:\n    def countStableSubsequences(self, nums: List[int]) -> int:\n        # dp[i][p][len] ? i-th num, p:odd / even, len: number\n        \n        even1 = even2 = odd1 = odd2 = 0\n\n        for x in nums:\n            p = (x & 1) # 0 = even, 1 = odd\n\n            if p == 0:\n                add_even1 = (1 + odd1 + odd2)\n                add_even2 = even1\n\n                even1 = (even1 + add_even1) # Not choose x + Choose x\n                even2 = (even2 + add_even2)\n            else:\n                add_odd1 = (1 + even1 + even2)\n                add_odd2 = odd1\n\n                odd1 = (odd1 + add_odd1)\n                odd2 = (odd2 + add_odd2)\n        return (even1 + even2 + odd1 + odd2) % MOD\n            ",
    "lang": "python3",
    "question_id": 4027,
    "contest_submission": 26446803
  },
  {
    "submission_id": 1769982657,
    "code": "class Solution:\n    def countStableSubsequences(self, nums: List[int]) -> int:\n        mod = 10 ** 9 + 7\n\n        e1 = e2 = o1 = o2 = 0\n        for v in nums:\n            if v % 2 == 1:\n                ne1 = (o1 + e1 + e2 + 1) % mod\n                ne2 = (o1 + o2) % mod\n                o1 = ne1\n                o2 = ne2\n            else:\n                ne1 = (e1 + o1 + o2 + 1) % mod\n                ne2 = (e1 + e2) % mod\n                e1 = ne1\n                e2 = ne2\n        return (e1 + e2 + o1 + o2) % mod",
    "lang": "python3",
    "question_id": 4027,
    "contest_submission": 26447393
  },
  {
    "submission_id": 1769969410,
    "code": "from typing import List\n\nclass Solution:\n    MOD = 1_000_000_007\n\n    def countStableSubsequences(self, nums: List[int]) -> int:\n        # even1, even2, odd1, odd2 as described\n        e1 = e2 = o1 = o2 = 0\n        M = self.MOD\n\n        for x in nums:\n            if x & 1:                            # x is odd\n                no1 = (o1 + e1 + e2 + 1) % M     # keep o1  + append to evens + new single\n                no2 = (o2 + o1) % M              # keep o2  + extend o1 \u2192 o2\n                ne1 = e1                         # skip x, evens unchanged in their buckets\n                ne2 = e2\n            else:                                # x is even\n                ne1 = (e1 + o1 + o2 + 1) % M\n                ne2 = (e2 + e1) % M\n                no1 = o1\n                no2 = o2\n\n            e1, e2, o1, o2 = ne1, ne2, no1, no2\n\n        return (e1 + e2 + o1 + o2) % M",
    "lang": "python3",
    "question_id": 4027,
    "contest_submission": 26437615
  },
  {
    "submission_id": 1769985141,
    "code": "class Solution:\n    def countStableSubsequences(self, nums: List[int]) -> int:\n        arr=nums[:]\n        mod=10**9+7\n\n        e1=e2=o1=o2=0\n\n        for a in nums:\n            nee1,nee2,neo1,neo2=e1,e2,o1,o2\n\n            if a%2==0:\n                nee2=(nee2+e1)%mod\n                nee1=(nee1+o1+o2+1)%mod\n            else:\n                neo2=(neo2+o1)%mod\n                neo1=(neo1+e1+e2+1)%mod\n            e1,e2,o1,o2=nee1,nee2,neo1,neo2\n\n        return (e1+e2+o1+o2)%mod",
    "lang": "python3",
    "question_id": 4027,
    "contest_submission": 26449166
  },
  {
    "submission_id": 1769986363,
    "code": "MOD = 10**9 + 7\n\nclass Solution:\n    def countStableSubsequences(self, nums: List[int]) -> int:\n        even_state = [0, 0]\n        odd_state = [0, 0]\n        \n        for value in nums:\n            if value % 2:\n                odd_1 = (odd_state[0] + sum(even_state) + 1) % MOD\n                odd_2 = sum(odd_state) % MOD\n                odd_state = [odd_1, odd_2]\n            else:\n                even_1 = (even_state[0] + sum(odd_state) + 1) % MOD\n                even_2 = sum(even_state) % MOD\n                even_state = [even_1, even_2]\n\n        return sum([*odd_state, *even_state]) % MOD",
    "lang": "python3",
    "question_id": 4027,
    "contest_submission": 26450065
  },
  {
    "submission_id": 1769986451,
    "code": "class Solution:\n    def countStableSubsequences(self, nums: List[int]) -> int:\n        mod = 10**9 + 7\n        odd = [0] * 2\n        even = [0] * 2\n        for num in nums:\n            if num % 2 == 0:\n                even[1] += even[0] % mod\n                even[0] += (odd[0] + odd[1] + 1) % mod\n            else:\n                odd[1] += odd[0] % mod\n                odd[0] += (even[0] + even[1] + 1) % mod\n        return (sum(even) + sum(odd)) % mod",
    "lang": "python3",
    "question_id": 4027,
    "contest_submission": 26450123
  },
  {
    "submission_id": 1769955863,
    "code": "class Solution:\n    def countStableSubsequences(self, nums: List[int]) -> int:\n        ans = 0\n        cnt = [[0,0],[0,0]]\n        z = o = 0\n        for x in nums:\n            # print(x, cnt, o, z)\n            if x%2 == 0:\n                ans += cnt[0][1] + cnt[1][1] + cnt[1][0]\n                cnt[0][0] += (cnt[1][0] + z) % (10**9+7)\n                cnt[1][0] += (cnt[0][1] + cnt[1][1] + o) % (10**9+7)\n            else:\n                ans += cnt[0][1] + cnt[0][0] + cnt[1][0]\n                cnt[1][1] += (cnt[0][1] + o) % (10**9+7)\n                cnt[0][1] += (cnt[0][0] + cnt[1][0] + z) % (10**9+7)\n            o += x%2 == 1\n            z += x%2 == 0\n        n = len(nums)\n        return (ans + n*(n+1)//2) % (10**9+7)",
    "lang": "python3",
    "question_id": 4027,
    "contest_submission": 26426748
  },
  {
    "submission_id": 1769987364,
    "code": "class Solution:\n    def countStableSubsequences(self, nums: List[int]) -> int:\n        mod = 10**9 + 7\n        n = len(nums)\n\n        answer = n\n\n        dp = [0, 0, 0, 0]  # ee, eo, oe, oo\n\n        ctr = [0, 0]\n        ctr[nums[0] % 2] += 1\n\n        for i, x in enumerate(nums[1:], 1):\n            temp = dp.copy()\n            \n            if x % 2 == 0:\n                temp[0] += ctr[0]\n                temp[1] += ctr[1]\n\n                temp[0] += dp[1]\n                temp[1] += dp[2] + dp[3]\n\n            else:\n                temp[2] += ctr[0]\n                temp[3] += ctr[1]\n\n                temp[2] += dp[0] + dp[1]\n                temp[3] += dp[2]\n\n            ctr[x % 2] += 1\n\n            dp = [y % mod for y in temp]\n\n        return (answer + sum(dp)) % mod\n                \n",
    "lang": "python3",
    "question_id": 4027,
    "contest_submission": 26450774
  },
  {
    "submission_id": 1769957971,
    "code": "MOD = 10**9+7\nclass Solution:\n    def countStableSubsequences(self, nums: List[int]) -> int:\n        @cache\n        def dfs(i, last, run):\n            if i == len(nums):\n                return int(last != -1)\n            res = dfs(i + 1, last, run)\n            if last == -1:\n                res += dfs(i + 1, nums[i] % 2, 1)\n                if res >= MOD:\n                    res -= MOD\n            else:\n                if nums[i] % 2 == last:\n                    if run < 2:\n                        res += dfs(i + 1, last, run + 1)\n                        if res >= MOD:\n                            res -= MOD\n                else:\n                    res += dfs(i + 1, last ^ 1, 1)\n                    if res >= MOD:\n                        res -= MOD\n            return res\n        res = dfs(0, -1, 0)\n        dfs.cache_clear()\n        return res",
    "lang": "python3",
    "question_id": 4027,
    "contest_submission": 26428500
  }
]