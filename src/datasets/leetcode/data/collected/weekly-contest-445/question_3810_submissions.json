[
  {
    "submission_id": 1605124396,
    "code": "\nfrom functools import lru_cache\n\nMOD = 10**9 + 7\n\ndef to_base(n: int, b: int) -> list:\n    if n == 0:\n        return [0]\n    digits = []\n    while n:\n        digits.append(n % b)\n        n //= b\n    return digits[::-1]\n\ndef str_decrement(s: str) -> str:\n    n = int(s)\n    return str(n - 1) if n > 0 else \"0\"\n\n\ndef count_non_decreasing(s: str, b: int) -> int:\n    digits = to_base(int(s), b)\n    n = len(digits)\n    \n    @lru_cache(maxsize=None)\n    def dp(pos: int, prev: int, tight: bool, leading_zero: bool) -> int:\n        if pos == n:\n            return 0 if leading_zero else 1\n\n        limit = digits[pos] if tight else b - 1\n        total = 0\n\n        for d in range(0, limit + 1):\n            if not leading_zero and d < prev:\n                continue\n\n            new_tight = tight and (d == limit)\n            new_leading_zero = leading_zero and (d == 0)\n            new_prev = d if not new_leading_zero else 0\n            total = (total + dp(pos + 1, new_prev, new_tight, new_leading_zero)) % MOD\n        \n        return total\n\n    return dp(0, 0, True, True)\n\nclass Solution:\n    def countNumbers(self, l: str, r: str, b: int) -> int:\n        count_r = count_non_decreasing(r, b)\n        count_l_minus = count_non_decreasing(str_decrement(l), b)\n        return (count_r - count_l_minus) % MOD\n        ",
    "lang": "python3",
    "question_id": 3810,
    "contest_submission": 23654687
  },
  {
    "submission_id": 1605130930,
    "code": "import sys\nsys.setrecursionlimit(10000)\n\nMOD = 10**9 + 7\n\nclass Solution:\n    def countNumbers(self, l: str, r: str, b: int) -> int:\n        def conv(x):\n            n = []\n            if x == 0:\n                return [0]\n            while x:\n                n.append(x % b)\n                x //= b\n            return n[::-1]\n        def calc(x):\n            d = conv(x)\n            n = len(d)\n            from functools import lru_cache\n            @lru_cache(maxsize = None)\n            def dp(i, last, tight):\n                if i == n:\n                    return 1\n                lim = d[i] if tight else b - 1\n                s = 0\n                if last == -1:\n                    for x in range(0, lim + 1):\n                        nt = tight and (x == lim)\n                        if x == 0:\n                            s = (s + dp(i + 1, -1, nt)) % MOD\n                        else:\n                            s = (s + dp(i + 1, x, nt)) % MOD\n                else:\n                    for x in range(last, lim + 1):\n                        nt = tight and (x == lim)\n                        s = (s + dp(i + 1, x, nt)) % MOD\n                return s\n            return dp(0, -1, True)\n        L = int(l)\n        R = int(r)\n        a = calc(R)\n        bVal = calc(L - 1) if L > 0 else 0\n        return (a - bVal) % MOD",
    "lang": "python3",
    "question_id": 3810,
    "contest_submission": 23659616
  },
  {
    "submission_id": 1605144099,
    "code": "MOD = 10 ** 9 + 7\n\n\nclass Solution:\n    def countNumbers(self, l: str, r: str, b: int) -> int:\n        def g(n):\n            n = int(n)\n            if n <= 0:\n                return []\n            arr = []\n            while n:\n                arr.append(n % b)\n                n //= b\n            return arr[::-1]\n\n        def f(n):\n            n = int(n)\n            if n <= 0:\n                return 0\n            x = g(str(n))\n            LIM = len(x)\n\n            @lru_cache(maxsize=None)\n            def dp(i, j, k, flag):\n                if i == LIM:\n                    return 1 if flag else 0\n\n                lim = x[i] if k else b - 1\n                # print(\"i\", i, \"j\", j, \"k\", k, \"flag\", flag, \"lim\", lim)\n\n                val = 0\n                for d in range(lim + 1):\n                    next_val = k and (d == lim)\n                    if not flag:\n                        if d == 0:\n                            val += dp(i + 1, 0, next_val, False)\n                            # print(\"i\", i, \"j\", j, \"k\", k, \"flag\", flag, \"d\", d, \"val\", val)\n                        else:\n                            val += dp(i + 1, d, next_val, True)\n                            # print(\"i\", i, \"j\", j, \"k\", k, \"flag\", flag, \"d\", d, \"val\", val)\n                    else:\n                        if d < j:\n                            continue\n                        val += dp(i + 1, d, next_val, True)\n                        # print(\"i\", i, \"j\", j, \"k\", k, \"flag\", flag, \"d\", d, \"val\", val)\n                return val % MOD\n\n            return dp(0, 0, True, False)\n\n        # print(\"l\", l)\n        return (f(r) - f(str(int(l) - 1))) % MOD\n",
    "lang": "python3",
    "question_id": 3810,
    "contest_submission": 23669059
  }
]