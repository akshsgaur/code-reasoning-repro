[
  {
    "submission_id": 1575085194,
    "code": "class Solution:\n    def beautifulNumbers(self, l: int, r: int) -> int:\n        def g(x):\n            return list(map(int, str(x)))\n        from functools import lru_cache\n        def h(x):\n            d = g(x)\n            @lru_cache(maxsize=None)\n            def f(i, t, st):\n                if i == len(d): return 1 if st else 0\n                a = 0\n                m = d[i] if t else 9\n                for j in range(m + 1):\n                    nt = t and (j == m)\n                    if not st and j == 0:\n                        a += f(i + 1, nt, False)\n                    else:\n                        if j == 0: continue\n                        a += f(i + 1, nt, True)\n                return a\n            return f(0, True, False)\n        def k(x):\n            d = g(x)\n            @lru_cache(maxsize=None)\n            def f(i, t, st, s, p):\n                if i == len(d): return 1 if st and p % s == 0 else 0\n                a = 0\n                m = d[i] if t else 9\n                for j in range(m + 1):\n                    nt = t and (j == m)\n                    if not st and j == 0:\n                        a += f(i + 1, nt, False, s, p)\n                    else:\n                        if j == 0: continue\n                        a += f(i + 1, nt, True, s + j, p * j)\n                return a\n            return f(0, True, False, 0, 1)\n        def c(x):\n            if x <= 0: return 0\n            return x - h(x) + k(x)\n        return c(r) - c(l - 1)\n",
    "lang": "python3",
    "question_id": 3801,
    "contest_submission": 23142718
  },
  {
    "submission_id": 1575096103,
    "code": "class Solution:\n    def beautifulNumbers(self, l: int, r: int) -> int:\n        def countBeautiful(X: int) -> int:\n            if X <= 0:\n                return 0\n            \n            digits = list(map(int, str(X)))\n            n = len(digits)\n            \n            from functools import lru_cache\n            \n            @lru_cache(maxsize=None)\n            def dp(pos, tight, started, hasZero, curr_sum, curr_prod):\n                if pos == n:\n                    if not started:\n                        return 0\n                    if hasZero:\n                        return 1\n                    return 1 if curr_prod % curr_sum == 0 else 0\n                    \n                total = 0\n                upper_bound = digits[pos] if tight else 9\n                \n                for d in range(0, upper_bound + 1):\n                    ntight = tight and (d == upper_bound)\n                    \n                    if not started:\n                        if d == 0:\n                            total += dp(pos+1, ntight, False, False, 0, 1)\n                        else:\n                            total += dp(pos+1, ntight, True, False, d, d)\n                    else:\n                        if d == 0:\n                            total += dp(pos+1, ntight, True, True, curr_sum + d, 0)\n                        else:\n                            if hasZero:\n                                new_prod = 0\n                            else:\n                                new_prod = curr_prod * d\n                            total += dp(pos+1, ntight, True, hasZero, curr_sum + d, new_prod)\n                            \n                return total\n            \n            return dp(0, True, False, False, 0, 1)\n        \n        return countBeautiful(r) - countBeautiful(l - 1)",
    "lang": "python3",
    "question_id": 3801,
    "contest_submission": 23151497
  },
  {
    "submission_id": 1575103497,
    "code": "from functools import lru_cache\nclass Solution(object):\n    def beautifulNumbers(self, l, r):\n        def sol(n):\n            if n < 0:\n                return 0\n            a = list(map(int, str(n)))\n            L = len(a)\n            @lru_cache(maxsize=None)\n            def rec(i, t, st, h, s, p):\n                if i == L:\n                    if not st:\n                        return 0\n                    return 1 if h or (p % s == 0) else 0\n                c = 0\n                m = a[i] if t else 9\n                for x in range(m+1):\n                    nt = t and (x == m)\n                    if not st:\n                        if x == 0:\n                            c += rec(i+1, nt, 0, 0, 0, 1)\n                        else:\n                            c += rec(i+1, nt, 1, 0, x, x)\n                    else:\n                        if x == 0:\n                            c += rec(i+1, nt, 1, 1, s, 0)\n                        else:\n                            if h:\n                                c += rec(i+1, nt, 1, 1, s+x, 0)\n                            else:\n                                c += rec(i+1, nt, 1, 0, s+x, p*x)\n                return c\n            return rec(0, True, 0, 0, 0, 1)\n        return sol(r) - sol(l-1)\n",
    "lang": "python3",
    "question_id": 3801,
    "contest_submission": 23157282
  }
]