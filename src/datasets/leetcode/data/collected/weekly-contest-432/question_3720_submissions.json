[
  {
    "submission_id": 1505695158,
    "code": "\nclass Solution:\n    def minMaxWeight(self, n: int, edges: List[List[int]], threshold: int) -> int:\n        G = [[] for _ in range(n)]\n        for u, v, w in edges:\n            G[v].append((u, w))\n\n        def dfs(u, visited, cap):\n            visited[u] = True\n            for v, w in G[u]:\n                if w <= cap and not visited[v]:\n                    dfs(v, visited, cap)\n\n        visited = [False] * n\n        dfs(0, visited, inf)\n        for i in range(n):\n            if not visited[i]:\n                return -1\n\n        L = 0\n        R = 1000000 + 20\n        while L + 1 < R:\n            mid = (L + R) // 2\n            visited = [False] * n\n            dfs(0, visited, mid)\n            ok = True\n            for i in range(n):\n                if not visited[i]:\n                    ok = False\n                    break\n            if ok:\n                R = mid\n            else:\n                L = mid\n\n        return R\n",
    "lang": "python3",
    "question_id": 3720,
    "contest_submission": 21983458
  },
  {
    "submission_id": 1505688956,
    "code": "class Solution:\n    def minMaxWeight(self, n: int, edges: List[List[int]], threshold: int) -> int:\n\n        ws = set()\n        graph = {}\n        rev = {}\n        for u, v, w in edges:\n            ws.add(w)\n            \n            if u not in graph:\n                graph[u] = defaultdict(lambda: float('inf'))\n            if v not in rev:\n                rev[v] = defaultdict(lambda: float('inf'))\n\n            graph[u][v] = min(graph[u][v], w)\n            rev[v][u] = min(rev[v][u], w)\n\n        q = deque([0])\n        seen = set([0])\n        while q:\n            v = q.popleft()\n            if v in rev:\n                for u in rev[v]:\n                    if u not in seen:\n                        q.append(u)\n                        seen.add(u)\n                        \n        if len(seen) < n:\n            return -1\n\n        def can(x):\n            q = deque([0])\n            seen = set([0])\n            while q:\n                v = q.popleft()\n                if v in rev:\n                    for u in rev[v]:\n                        if rev[v][u] <= x and u not in seen:\n                            q.append(u)\n                            seen.add(u)\n            return len(seen) == n\n\n        l, r = min(ws), max(ws)\n        while l < r:\n            mid = (l + r) // 2\n            if can(mid):\n                r = mid\n            else:\n                l = mid + 1\n        return l",
    "lang": "python3",
    "question_id": 3720,
    "contest_submission": 21979498
  },
  {
    "submission_id": 1505677494,
    "code": "class Solution:\n    def minMaxWeight(self, n: int, edges: List[List[int]], threshold: int) -> int:\n        g = [[] for _ in range(n)]\n        m = 1\n        for u, v, w in edges:\n            g[v].append((u, w))\n            if w > m:\n                m = w\n        def check(mid):\n            vis = [0] * n\n            vis[0] = 1\n            Q = deque([0])\n            while Q:\n                u = Q.popleft()\n                for v, w in g[u]:\n                    if w <= mid and not vis[v]:\n                        Q.append(v)\n                        vis[v] = 1\n            return sum(vis) == n\n                        \n        \n        lo, hi = 1, m + 1\n        while lo < hi:\n            mid = (lo + hi) // 2\n            if check(mid):\n                hi = mid\n            else:\n                lo = mid + 1\n        return -1 if lo > m else lo",
    "lang": "python3",
    "question_id": 3720,
    "contest_submission": 21972046
  }
]